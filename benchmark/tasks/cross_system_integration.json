{
  "category": "cross_system_integration",
  "description": "Tasks requiring coordination of data across multiple healthcare systems to answer clinical questions. This is the unique value of HDH-Bench - testing agents' ability to navigate fragmented healthcare data.",
  "tasks": [
    {
      "task_id": "HDH-CSI-001",
      "category": "cross_system_integration",
      "difficulty": "medium",
      "title": "Complete Medication History",
      "description": "For patient MRN-100042 in the EHR, retrieve their complete medication history by: 1) Finding the patient across systems using the MPI, 2) Getting current prescriptions from Pharmacy, 3) Getting medication administrations during encounters from PAS. Return a unified list.",
      "systems_required": ["ehr", "pharmacy", "pas"],
      "max_turns": 20,
      "success_criteria": {
        "type": "threshold",
        "target_field": "medication_completeness",
        "threshold": 0.8
      },
      "grading": {
        "weight": 0.05,
        "sub_goals": [
          {"id": "find_patient_ids", "description": "Found patient in all required systems", "points": 0.3},
          {"id": "pharmacy_meds", "description": "Retrieved pharmacy medications", "points": 0.3},
          {"id": "unified_list", "description": "Created unified medication list", "points": 0.4}
        ]
      },
      "expected_response": {
        "patient": {
          "ehr_id": "string",
          "pharmacy_id": "string",
          "pas_id": "string"
        },
        "medications": [
          {
            "name": "string",
            "rxnorm": "string",
            "source": "pharmacy|ehr|pas",
            "status": "active|completed|stopped"
          }
        ],
        "total_count": "integer"
      }
    },
    {
      "task_id": "HDH-CSI-002",
      "category": "cross_system_integration",
      "difficulty": "hard",
      "title": "Lab-Diagnosis Correlation",
      "description": "Find all patients with Type 2 Diabetes (ICD-10 E11.x) in the EHR who have had HbA1c tests in the LIS. Return the correlation between diagnosis date and lab monitoring frequency. This requires matching patients across EHR and LIS systems.",
      "systems_required": ["ehr", "lis"],
      "max_turns": 25,
      "success_criteria": {
        "type": "threshold",
        "target_field": "patients_matched",
        "threshold": 0.8
      },
      "grading": {
        "weight": 0.06,
        "sub_goals": [
          {"id": "find_diabetics", "description": "Found diabetic patients in EHR", "points": 0.25},
          {"id": "match_to_lis", "description": "Matched patients to LIS IDs", "points": 0.35},
          {"id": "retrieve_labs", "description": "Retrieved HbA1c results", "points": 0.25},
          {"id": "correlation", "description": "Computed monitoring correlation", "points": 0.15}
        ]
      },
      "expected_response": {
        "diabetic_patients": "integer",
        "patients_with_hba1c": "integer",
        "match_rate": "float (0-1)",
        "monitoring_stats": {
          "avg_tests_per_patient": "float",
          "patients_with_no_tests": "integer"
        },
        "sample_correlations": [
          {
            "ehr_id": "string",
            "lis_id": "string",
            "diagnosis_date": "string",
            "first_hba1c_date": "string",
            "total_hba1c_tests": "integer"
          }
        ]
      }
    },
    {
      "task_id": "HDH-CSI-003",
      "category": "cross_system_integration",
      "difficulty": "hard",
      "title": "Multi-System Care Gap Analysis",
      "description": "Identify patients with hypertension (ICD-10 I10) in the EHR who are prescribed antihypertensives in Pharmacy but have no blood pressure readings in LIS/EHR in the last 6 months. This is a common care gap analysis requiring cross-system data.",
      "systems_required": ["ehr", "pharmacy", "lis"],
      "max_turns": 30,
      "success_criteria": {
        "type": "f1_score",
        "target_field": "care_gap_patients",
        "threshold": 0.7
      },
      "grading": {
        "weight": 0.07,
        "sub_goals": [
          {"id": "hypertension_cohort", "description": "Built hypertension patient cohort", "points": 0.25},
          {"id": "matched_pharmacy", "description": "Matched to pharmacy records", "points": 0.25},
          {"id": "checked_vitals", "description": "Checked for BP readings", "points": 0.25},
          {"id": "identified_gaps", "description": "Identified care gaps correctly", "points": 0.25}
        ]
      },
      "expected_response": {
        "hypertension_patients": "integer",
        "on_antihypertensives": "integer",
        "missing_bp_readings": "integer",
        "care_gap_rate": "float (0-1)",
        "sample_gaps": [
          {
            "ehr_id": "string",
            "pharmacy_id": "string",
            "last_bp_date": "string or null",
            "current_medications": ["list of antihypertensive names"]
          }
        ]
      }
    },
    {
      "task_id": "HDH-CSI-004",
      "category": "cross_system_integration",
      "difficulty": "expert",
      "title": "Medication-Lab Monitoring Compliance",
      "description": "For patients on metformin (RxNorm 860975) in Pharmacy, verify they have renal function monitoring (creatinine, eGFR) in LIS as per clinical guidelines. Metformin requires kidney function monitoring. Identify non-compliant patients.",
      "systems_required": ["pharmacy", "lis", "ehr"],
      "max_turns": 35,
      "success_criteria": {
        "type": "f1_score",
        "target_field": "non_compliant_patients",
        "threshold": 0.7
      },
      "grading": {
        "weight": 0.08,
        "sub_goals": [
          {"id": "metformin_patients", "description": "Found metformin patients", "points": 0.2},
          {"id": "matched_lis", "description": "Matched to LIS records", "points": 0.2},
          {"id": "checked_renal", "description": "Found renal function tests", "points": 0.3},
          {"id": "compliance_calc", "description": "Calculated compliance correctly", "points": 0.3}
        ]
      },
      "expected_response": {
        "metformin_patients": "integer",
        "with_renal_monitoring": "integer",
        "without_monitoring": "integer",
        "compliance_rate": "float (0-1)",
        "high_risk_patients": [
          {
            "ehr_id": "string",
            "pharmacy_id": "string",
            "metformin_start_date": "string",
            "last_creatinine_date": "string or null",
            "last_egfr_value": "number or null"
          }
        ]
      }
    },
    {
      "task_id": "HDH-CSI-005",
      "category": "cross_system_integration",
      "difficulty": "expert",
      "title": "Billing Reconciliation with Clinical",
      "description": "Compare diagnoses recorded in the EHR (Conditions) with diagnoses submitted for billing (Claims in Billing system). Identify discrepancies where clinical records don't match billing codes. This tests understanding of clinical vs. administrative data.",
      "systems_required": ["ehr", "billing"],
      "max_turns": 30,
      "success_criteria": {
        "type": "threshold",
        "target_field": "discrepancy_detection",
        "threshold": 0.7
      },
      "grading": {
        "weight": 0.07,
        "sub_goals": [
          {"id": "get_clinical", "description": "Retrieved clinical diagnoses", "points": 0.25},
          {"id": "get_billing", "description": "Retrieved billing diagnoses", "points": 0.25},
          {"id": "match_patients", "description": "Matched patients across systems", "points": 0.25},
          {"id": "find_discrepancies", "description": "Identified discrepancies", "points": 0.25}
        ]
      },
      "expected_response": {
        "patients_analyzed": "integer",
        "billing_only_diagnoses": "integer",
        "clinical_only_diagnoses": "integer",
        "matched_diagnoses": "integer",
        "discrepancy_rate": "float (0-1)",
        "sample_discrepancies": [
          {
            "patient_ehr_id": "string",
            "patient_billing_id": "string",
            "clinical_codes": ["list of ICD codes"],
            "billing_codes": ["list of ICD codes"],
            "missing_from_billing": ["list of codes"],
            "missing_from_clinical": ["list of codes"]
          }
        ]
      }
    }
  ]
}
